@{
    ViewBag.Title = "项目信息管理/项目信息表单";
    Layout = "~/Views/Shared/_LayoutForm.cshtml";
}
<script src="~/Content/Scripts/jquery/jquery-1.11.3.min.js"></script>
<script type="text/javascript">
    var KeyValue = GetQuery('KeyValue');
    var TreeId = GetQuery('TreeId');
    var ItemID = GetQuery('ItemID');
    var Info = GetQuery('Info');

    $(function () {
        InitControl();
    })

    //得到一个对象实体
    function InitControl() {
        if (KeyValue=="") {
            document.getElementById("ProjectLogo").value="Logo.png";
            document.getElementById("ProjectLogo").readOnly=true;
            document.getElementById("ProjectBackground").value="Background.png";
            document.getElementById("ProjectBackground").readOnly=true;
            document.getElementById("btn_ProjectLogo").style.display="none";
            document.getElementById("btn_ProjectBackground").style.display="none";
        } else if (Info == 1 && KeyValue!="") {
            document.getElementById("btn_ProjectLogo").style.display = "none";
            document.getElementById("btn_ProjectBackground").style.display = "none";
            document.getElementById("ProjectLogo").readOnly=true;
            document.getElementById("ProjectBackground").readOnly=true;
            document.getElementById("ConstructionUnit").readOnly = true;
            document.getElementById("ProjectAddress").readOnly = true;
            document.getElementById("DesignUnit").readOnly = true;
            document.getElementById("SupervisionUnit").readOnly = true;
            document.getElementById("GeneralContractor").readOnly = true;
            document.getElementById("ProfessionalContractor").readOnly = true;
            document.getElementById("Description").readOnly = true;
            AjaxJson("/SteelMember/ProjectInfo/SetDataForm", { KeyValue: KeyValue }, function (data) {
                SetWebControls(data);
            });
        }else {
            AjaxJson("/SteelMember/ProjectInfo/SetDataForm", { KeyValue: KeyValue }, function (data) {
                SetWebControls(data);
                $("#ProjectName").focus();
                $("#ProjectName").select();
            });
        }
    }

    //保存事件
    function AcceptClick() {
        if (!CheckDataValid('#form2')) {
            return false;
        }
        Loading(true, "正在提交数据...");
        window.setTimeout(function () {
            var postData = GetWebControls("#form2");
            AjaxJson("/SteelMember/ProjectInfo/SubmitDataForm?KeyValue=" + KeyValue + '&TreeId=' + TreeId, postData, function (data) {//+ '&ItemID=' + ItemID
                tipDialog(data.Message, 3, data.Code);
                top.frames[tabiframeId()].windowload();
                closeDialog();
            });
        }, 200);
    }

    //上传logo
    function LogoUpload() {
        var Logo="Logo"
        var url = "/SteelMember/File/UpLoadFile?KeyValue=" + KeyValue+"&Logo="+Logo;
        Dialog(url, "UpLoadFile", "上传文件到网络硬盘", 500, 600, function (iframe) {
            top.frames[iframe].AcceptClick()
            $("#gridTable").trigger("reloadGrid"); //重新载入
        });
    }

    //上传背景图片
    function BackgroundUpload(){var Background="Background"
        var url = "/SteelMember/File/UpLoadFile?KeyValue=" + KeyValue+"&Background="+Background;
        Dialog(url, "UpLoadFile", "上传文件到网络硬盘", 500, 600, function (iframe) {
            top.frames[iframe].AcceptClick()
            $("#gridTable").trigger("reloadGrid"); //重新载入
        });
    }
</script>

<form id="form2" style="margin: 25px; margin-left: 40px; margin-right: 40px;">
    <div>
        <table class="form">
            <tr>
                <th class="formTitle">
                    项目Logo：
                </th>
                <td class="formValue">
                    <input id="ProjectLogo" type="text" class="txt" />
                    <input id="btn_ProjectLogo" type="button" onclick="LogoUpload(@ViewData["projectid"])" value="上传" />
                </td>
            </tr>
            <tr>
                <th class="formTitle">
                    项目背景：
                </th>
                <td class="formValue">
                    <input id="ProjectBackground" type="text" class="txt" />
                    <input id="btn_ProjectBackground" type="button" onclick="BackgroundUpload(@ViewData["projectid"])" value="上传" />
                </td>
            </tr>
            <tr>
                <th class="formTitle">
                    项目地址：
                </th>
                <td class="formValue">
                    <input id="ProjectAddress" type="text" class="txt" />
                </td>
            </tr>
            <tr>
                <th class="formTitle">
                    建设单位：
                </th>
                <td class="formValue">
                    <input id="ConstructionUnit" type="text" class="txt" />
                </td>
              
            </tr>
          
            <tr>
                <th class="formTitle">
                    设计单位：
                </th>
                <td class="formValue">
                    <input id="DesignUnit" type="text" class="txt" />
                </td>
            </tr>
            <tr>
                <th class="formTitle">监理单位：</th>
                <td class="formValue">
                    <input id="SupervisionUnit" type="text" class="txt" />
                </td>
            </tr>
            <tr>
                <th class="formTitle">总承包商：</th>
                <td class="formValue">
                    <input id="GeneralContractor" type="text" class="txt" />
                </td>
            </tr>
            <tr>
                <th class="formTitle">专业承包商：</th>
                <td class="formValue">
                    <input id="ProfessionalContractor" type="text" class="txt" />
                </td>

            </tr>
            <tr>
                <th class="formTitle">
                    备注：
                </th>
                <td class="formValue">
                    <textarea id="Description" name="Description" maxlength="200" class="txtArea" rows="5"></textarea>
                </td>
            </tr>
        </table>
    </div>
</form>